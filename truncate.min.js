"use strict";!function(a){function c(a,c){this.jQueryObject=c,this.elements=[],this.data=jQuery.extend(!0,b,a),this.stringHelper=new d,this.init()}function d(){}var b={breakWords:!1,overflowHidden:!0,refreshOnWindowResize:!0,suffix:"...",maximumWordLenght:255,refreshResizeDelay:50};a.fn.truncate=function(b){return new c(b,a(this))},c.prototype={init:function(){this._destroy=!1,this.initElements(),this.hideOverflowContent(),this.bindEvents()},bindEvents:function(){var b=this;if(this.data.refreshOnWindowResize){var c;a(window).on("resize",function(d){this._destroy&&(a(this).unbind(d),d.prevendDefault()),clearTimeout(c),c=setTimeout(function(){b.refreshElements(),b.hideOverflowContent(!0)},b.data.refreshResizeDelay)})}},initElements:function(){var a=this;this.jQueryObject.each(function(b,c){a.elements.push(a.getInfoElement(c))})},hideOverflowContent:function(a){for(var b=0;b<this.elements.length;b++){var c=this.elements[b].overflowWidth||this.elements[b].overflowHeight;if(c||a){this.addCss(b);var d=this.elements[b].originalContent,e=d.split(" ");this.elements[b].jQueryObject.html("");for(var f="",g=0;g<e.length;g++){var h=this.getTruncatedWordForElement(e[g],b);if(0==g)f=h;else{var i=f+" "+h;if(i=this.stringHelper.trim(i,["."," "])+this.data.suffix,this.checkIfHeightWordIsTooLongForElement(i,b))break;f+=" "+h}}f=this.stringHelper.trim(f,[" ","."]),f.split(" ").length!=this.elements[b].originalContent.split(" ").length&&(f+=this.data.suffix),this.setTextToElement(b,f)}}},addCss:function(a){if(!this.elements[a].cssAlreadyAdded){if(this.elements[a].cssAlreadyAdded=!0,this.elements[a].originalCss={},this.data.breakWords){var b=this.elements[a].jQueryObject.css("word-break"),c=this.elements[a].jQueryObject.css("hyphens");this.elements[a].originalCss["word-break"]=b?b:"",this.elements[a].originalCss.hyphens=c?c:"",this.elements[a].jQueryObject.css({"word-break":"break-all",hyphens:"auto"})}if(this.data.overflowHidden){var d=this.elements[a].jQueryObject.css("overflow");this.elements[a].originalCss.overflow=d?d:"",this.elements[a].jQueryObject.css("overflow","hidden")}}},setTextToElement:function(a,b){return this.elements[a].jQueryObject.html(b),this.refreshElement(a),this},refreshElement:function(a){return this.elements[a].scrollWidth=this.elements[a].element.scrollWidth,this.elements[a].innerWidth=this.elements[a].jQueryObject.innerWidth(),this.elements[a].scrollHeight=this.elements[a].element.scrollHeight,this.elements[a].innerHeight=this.elements[a].jQueryObject.innerHeight(),this.elements[a].overflowWidth=this.elements[a].scrollWidth>this.elements[a].jQueryObject.innerWidth(),this.elements[a].overflowHeight=this.elements[a].scrollHeight>this.elements[a].jQueryObject.innerHeight(),this},getInfoElement:function(b){var c=a(b),d={jQueryObject:c,element:b,scrollWidth:b.scrollWidth,innerWidth:c.innerWidth(),scrollHeight:b.scrollHeight,innerHeight:c.innerHeight(),originalContent:this.stringHelper.trim(c.html(),["\r\n","\n","\r"," "])};return d.overflowWidth=d.scrollWidth>d.jQueryObject.innerWidth(),d.overflowHeight=d.scrollHeight>d.jQueryObject.innerHeight(),d},refreshElements:function(){for(var a=0;a<this.elements.length;a++)this.refreshElement(a)},getTruncatedWordForElement:function(a,b){for(var c=!1,d=this.data.maximumWordLenght;this.checkIfWidthWordIsTooLongForElement(a+this.data.suffix,b)&&d>0;)c=!0,a=a.substr(0,a.length-1),d--;return c?a+this.data.suffix:a},checkIfWidthWordIsTooLongForElement:function(a,b){return this.checkIfSizeWordIsTooLongForElement("width",a,b)},checkIfHeightWordIsTooLongForElement:function(a,b){return this.checkIfSizeWordIsTooLongForElement("height",a,b)},checkIfSizeWordIsTooLongForElement:function(a,b,c){var d=this.elements[c].jQueryObject.html();this.setTextToElement(c,b);var e="overflow"+this.stringHelper.capitalize(a);return this.elements[c][e]?(this.elements[c].jQueryObject.html(d),!0):(this.elements[c].jQueryObject.html(d),!1)},destroy:function(){return this.resetElements(),this.elements=[],this.jQueryObject=[],this.data=[],this.stringHelper=null,this._destroy=!0,!0},resetCssForElement:function(b){var c=this;"undefined"!=typeof this.elements[b].originalCss&&a.each(this.elements[b].originalCss,function(a,d){c.elements[b].jQueryObject.css(a,d)})},resetElements:function(){for(var a=0;a<this.elements.length;a++)this.resetCssForElement(a),this.setTextToElement(a,this.elements[a].originalContent)},getItemByJqueryObject:function(a){for(var b=0;b<this.elements.length;b++)if(a==this.elements[b].jQueryObject.get(0))return this.elements[b];return!1}},d.prototype={capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},trim:function(a,b){return this.leftTrim(this.rightTrim(a,b),b)},leftTrim:function(a,b){return b=b||"\\s",a.replace(new RegExp("^["+b+"]+","g"),"")},rightTrim:function(a,b){return b=b||"\\s",a.replace(new RegExp("["+b+"]+$","g"),"")}}}(jQuery);
